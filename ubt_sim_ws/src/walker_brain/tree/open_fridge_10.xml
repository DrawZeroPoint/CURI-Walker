<?xml version="1.0"?>
<root main_tree_to_execute="BehaviorTree">
    <!-- ////////// -->
    <BehaviorTree ID="BehaviorTree">
        <Sequence>
            <Action ID="ExecuteMoveBase" name="Turn right" pose="0 0 -0.41" service_name="execute_move_base"/>
            <Action ID="ExecuteMoveBase" name="Move backward" pose="-0.1 0 0" service_name="execute_move_base"/>
            <Action ID="ExecuteRArmMove" ee_link="right_tcp" name="Lift right arm" pose="0.419 -0.061 -0.008 0.02 0.049 0.704 0.708" ref_link="base_link" server_name="/walker/move_helper_right_arm/move_to_ee_pose"/>
            <Action ID="ExecuteRArmMove" ee_link="right_tcp" name="Approach to handle" pose="0.428 -0.002 0.002 0.02 0.052 0.69 0.722" ref_link="base_link" server_name="/walker/move_helper_right_arm/move_to_ee_pose"/>
            <Action ID="ExecuteRHandGrasp" name="Grasp the handle" server_name="/walker/hand_helper_right/grasp" type="1"/>
            <Action ID="ExecuteRArmMove" ee_link="right_tcp" name="Open the door" pose="-0.15 0.15 0 0 0 0 1" ref_link="right_tcp" server_name="/walker/move_helper_right_arm/move_to_ee_pose"/>
            <Action ID="ExecuteRArmMove" ee_link="right_tcp" name="Adjust right hand pose" pose="-0.01 -0.01 0 0 0 0.087 0.996" ref_link="right_tcp" server_name="/walker/move_helper_right_arm/move_to_ee_pose"/>
            <Action ID="ExecuteLArmMove" ee_link="left_tcp" name="Lift left arm" pose="0.368 0.074 -0.09 0.095 -0.138 -0.451 0.877" ref_link="base_link" server_name="/walker/move_helper_left_arm/move_to_ee_pose"/>
            <Action ID="ExecuteRHandGrasp" name="Release right hand" server_name="/walker/hand_helper_right/grasp" type="0"/>
            <Action ID="ExecuteRArmJointStates" execute_pose="0 0 0 0 0 0 0" name="Lay down right arm" server_name="/walker/move_helper_right_arm/move_to_joint_pose"/>
            <Action ID="ExecuteLArmMove" ee_link="left_tcp" name="Left arm reach to the door" pose="0.1 0.05 0 0 0 0 1" ref_link="left_tcp" server_name="/walker/move_helper_left_arm/move_to_ee_pose"/>
            <Action ID="ExecuteLArmMove" ee_link="left_tcp" name="Pull the door" pose="0.332 -0.055 -0.114 0.125 -0.102 -0.664 0.73" ref_link="base_link" server_name="/walker/move_helper_left_arm/move_to_ee_pose"/>
            <Fallback name="Check contact">
                <Action ID="EstimateContactForce" id="left_wrist" service_name="estimate_contact_force"/>
                <Action ID="ExecuteMoveBase" pose="0 0 -0.5" service_name="execute_move_base"/>
            </Fallback>
        </Sequence>
    </BehaviorTree>
    <!-- ////////// -->
    <TreeNodesModel>
        <Action ID="EstimateAdjustPose">
            <input_port default="estimate_adjust_pose" name="service_name"/>
            <output_port default="{adjust_pose}" name="tgt_nav_pose"/>
        </Action>
        <Action ID="EstimateContactForce">
            <input_port name="id">Could be left_wrist or right_wrist</input_port>
            <input_port default="estimate_contact_force" name="service_name"/>
        </Action>
        <Action ID="EstimateTargetPose">
            <input_port default="{detected_poses}" name="obj_poses"/>
            <input_port default="estimate_target_pose" name="service_name"/>
            <output_port default="{target_nav_pose}" name="tgt_nav_pose"/>
        </Action>
        <Action ID="ExecuteAdjustBase">
            <input_port default="0 -0.12 0" name="pose"/>
            <input_port default="move_to_pose2d" name="service_name"/>
        </Action>
        <Action ID="ExecuteHeadJointStates">
            <input_port name="execute_pose"/>
            <input_port name="server_name"/>
        </Action>
        <Action ID="ExecuteLArmMove">
            <input_port default="left_tcp" name="ee_link">The link to be controlled, default is left_tcp</input_port>
            <input_port name="pose"/>
            <input_port default="base_link" name="ref_link">Could be base_link or left_tcp</input_port>
            <input_port default="/walker/move_helper_left_arm/move_to_ee_pose" name="server_name"/>
        </Action>
        <Action ID="ExecuteMoveBase">
            <input_port default="{target_nav_pose}" name="pose"/>
            <input_port default="execute_move_base" name="service_name"/>
        </Action>
        <Action ID="ExecutePrePose">
            <input_port default="open_fridge" name="service_name"/>
        </Action>
        <Action ID="ExecuteRArmJointStates">
            <input_port default="0 0 0 0 0 0 0" name="execute_pose"/>
            <input_port default="/walker/move_helper_right_arm/move_to_joint_pose" name="server_name"/>
        </Action>
        <Action ID="ExecuteRArmMove">
            <input_port default="right_tcp" name="ee_link"/>
            <input_port name="pose"/>
            <input_port default="base_link" name="ref_link"/>
            <input_port default="/walker/move_helper_right_arm/move_to_ee_pose" name="server_name"/>
        </Action>
        <Action ID="ExecuteRHandGrasp">
            <input_port default="/walker/hand_helper_right/grasp" name="server_name"/>
            <input_port default="1" name="type"/>
        </Action>
        <Action ID="ExecuteStabilizeBase">
            <input_port default="stabilize_base" name="service_name"/>
        </Action>
        <Action ID="SenseObjectPoses">
            <input_port default="box" name="goal_id"/>
            <output_port default="{detected_poses}" name="poses"/>
            <input_port default="/head/extract_object_on_top" name="service_name"/>
        </Action>
    </TreeNodesModel>
    <!-- ////////// -->
</root>

